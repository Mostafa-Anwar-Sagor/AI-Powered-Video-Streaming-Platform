{% extends 'netflix/admin/base.html' %}

{% block title %}{% if category %}Edit Category{% else %}Add New Category{% endif %} - StreamFlix Content Manager{% endblock %}

{% block content %}
<div class="admin-header">
    <h1 class="admin-title">{% if category %}Edit Category{% else %}Add New Category{% endif %}</h1>
    <a href="{% url 'netflix:admin_category_list' %}" class="btn btn-secondary">‚Üê Back to Categories</a>
</div>

<div class="admin-card" style="max-width: 800px; margin: 0 auto;">
    <form method="POST" action="">
        {% csrf_token %}
        
        <div class="form-group">
            <label class="form-label">Category Name *</label>
            <input type="text" name="name" class="form-control" value="{{ category.name }}" required>
            <small style="color: #8c8c8c;">The display name for this category (e.g., "Trending Now", "Action Movies")</small>
        </div>

        <div class="form-group">
            <label class="form-label">Slug *</label>
            <input type="text" name="slug" class="form-control" value="{{ category.slug }}" required>
            <small style="color: #8c8c8c;">URL-friendly version (e.g., "trending-now", "action-movies")</small>
        </div>

        <div class="form-group">
            <label class="form-label">Description</label>
            <textarea name="description" class="form-control" rows="4">{{ category.description }}</textarea>
            <small style="color: #8c8c8c;">Optional description for internal reference</small>
        </div>

        <div class="form-group">
            <label class="form-label">Display Order *</label>
            <input type="number" name="order" class="form-control" value="{{ category.order|default:1 }}" min="1" required>
            <small style="color: #8c8c8c;">Lower numbers appear first on the homepage (e.g., 1, 2, 3...)</small>
        </div>

        <div class="form-group">
            <label style="display: flex; align-items: center; cursor: pointer; color: #e5e5e5;">
                <input 
                    type="checkbox" 
                    name="is_active" 
                    value="true"
                    {% if category.is_active or not category %}checked{% endif %}
                    style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;"
                >
                <span>Active (Visible on site)</span>
            </label>
            <small style="color: #8c8c8c; margin-left: 28px;">Inactive categories won't be shown to users</small>
        </div>

        <div style="margin-top: 40px; display: flex; gap: 15px;">
            <button type="submit" class="btn btn-primary">
                {% if category %}üíæ Update Category{% else %}‚ûï Create Category{% endif %}
            </button>
            <a href="{% url 'netflix:admin_category_list' %}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>

{% if category %}
<div class="admin-card" style="max-width: 800px; margin: 24px auto 0;">
    <h3 style="color: #e5e5e5; margin-bottom: 15px;">
        üìä Category Stats
    </h3>
    <div style="background: #2a2a2a; padding: 20px; border-radius: 8px;">
        <p style="color: #b3b3b3; margin-bottom: 10px;">
            <strong style="color: #E50914;">{{ category.name }}</strong> currently has 
            <strong style="color: #46d369;">{{ category.video_set.count }}</strong> video{% if category.video_set.count != 1 %}s{% endif %}.
        </p>
        {% if category.video_set.exists %}
        <a href="{% url 'netflix:admin_video_list' %}?category={{ category.id }}" class="btn btn-secondary" style="margin-top: 10px;">
            View Videos in This Category
        </a>
        {% endif %}
    </div>
</div>
{% endif %}
{% endblock %}
